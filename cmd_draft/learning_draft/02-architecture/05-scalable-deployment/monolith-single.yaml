# yaml-language-server: $schema=https://lokstra.dev/schema/lokstra.json

# Monolith Single Port Deployment
# All services on same server, same port
# Best for: Development, local testing
# Performance: Fastest (no network overhead, uses httptest)

services:
  # Infrastructure Layer
  - name: db
    type: DBService

  - name: cache
    type: CacheService

  # Repository Layer
  - name: product-repo
    type: ProductRepository
    config:
      db_service: db
      cache_service: cache

  - name: order-repo
    type: OrderRepository
    config:
      db_service: db
  
  # Business Logic Layer
  - name: product-svc
    type: ProductService
    config:
      repo_service: product-repo

  - name: order-svc
    type: OrderService
    config:
      repo_service: order-repo

servers:
  - name: monolith
    deployment-id: monolith-dev
    apps:
      - addr: :8080 
        routers: [product-api, order-api, health-api]
