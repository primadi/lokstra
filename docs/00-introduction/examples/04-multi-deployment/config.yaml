# ========================================
# Multi-Deployment Configuration
# ========================================
#
# This single config defines 3 different deployments:
#   1. monolith     - All services in one process (dev/small apps)
#   2. user-service - Only user endpoints (microservices)
#   3. order-service - Only order endpoints (microservices)
#

# ========================================
# Service Definitions (Global) - MAP format
# ========================================

service-definitions:
  database:
    type: database-factory

  user-service:
    type: user-service-factory
    depends-on:
      - database

  order-service:
    type: order-service-factory
    depends-on:
      - database
      - user-service  # Can be local OR remote

# ========================================
# Remote Service Definitions (for microservices) - MAP format
# ========================================

remote-service-definitions:
  user-service-remote:
    url: "http://localhost:3004"
    resource: "user"
    resource-plural: "users"

# ========================================
# Deployments - MAP format
# ========================================

deployments:
  # ========================================
  # MONOLITH: All services in one process
  # ========================================
  monolith:
    servers:
      api:
        base-url: "http://localhost"
        apps:
          - addr: ":3003"
            required-services:
              - database
              - user-service
              - order-service

  # ========================================
  # USER SERVICE: Only user-related endpoints
  # ========================================
  user-service:
    servers:
      user-api:
        base-url: "http://localhost"
        apps:
          - addr: ":3004"
            required-services:
              - database
              - user-service

  # ========================================
  # ORDER SERVICE: Order endpoints + remote user service
  # ========================================
  order-service:
    servers:
      order-api:
        base-url: "http://localhost"
        apps:
          - addr: ":3005"
            required-services:
              - database
              - order-service
            required-remote-services:
              - user-service-remote  # Uses HTTP client to call user-service
