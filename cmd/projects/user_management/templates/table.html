{{define "table"}}
<div class="{{.CSS.Container | default "overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg"}}">
    <!-- Table Header -->
    {{if .Title}}
    <div class="{{.CSS.Header | default "bg-white px-4 py-5 border-b border-gray-200 sm:px-6"}}">
        <div class="flex items-center justify-between">
            <div>
                <h3 class="text-lg leading-6 font-medium text-gray-900">{{.Title}}</h3>
                {{if .Description}}
                <p class="mt-1 max-w-2xl text-sm text-gray-500">{{.Description}}</p>
                {{end}}
            </div>
            {{if .Actions}}
            <div class="flex space-x-2">
                {{range .Actions}}
                <button type="button" 
                        {{if .HTMX}}{{.HTMX | renderHTMXAttrs}}{{end}}
                        {{if .Alpine}}{{.Alpine | renderAlpineAttrs}}{{end}}
                        class="{{.CSS | default "inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"}}">
                    {{if .Icon}}<i class="{{.Icon}} mr-2"></i>{{end}}
                    {{.Label}}
                </button>
                {{end}}
            </div>
            {{end}}
        </div>
    </div>
    {{end}}
    
    <!-- Filters and Search -->
    {{if .Filters}}
    <div class="{{.CSS.Filters | default "bg-gray-50 px-4 py-3 border-b border-gray-200"}}">
        <div class="flex items-center space-x-4">
            {{range .Filters}}
            {{if eq .Type "search"}}
            <div class="flex-1 min-w-0">
                <label for="{{.Name}}" class="sr-only">{{.Label}}</label>
                <div class="relative">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <i class="fas fa-search text-gray-400"></i>
                    </div>
                    <input type="search" 
                           name="{{.Name}}" 
                           id="{{.Name}}"
                           placeholder="{{.Placeholder | default "Search..."}}"
                           {{if .HTMX}}{{.HTMX | renderHTMXAttrs}}{{end}}
                           class="block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                </div>
            </div>
            {{else if eq .Type "select"}}
            <div>
                <label for="{{.Name}}" class="block text-sm font-medium text-gray-700">{{.Label}}</label>
                <select name="{{.Name}}" 
                        id="{{.Name}}"
                        {{if .HTMX}}{{.HTMX | renderHTMXAttrs}}{{end}}
                        class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md">
                    <option value="">All {{.Label}}</option>
                    {{range .Options}}
                    <option value="{{.Value}}">{{.Label}}</option>
                    {{end}}
                </select>
            </div>
            {{end}}
            {{end}}
        </div>
    </div>
    {{end}}
    
    <!-- Table -->
    <table class="{{.CSS.Table | default "min-w-full divide-y divide-gray-300"}}">
        <thead class="{{.CSS.Head | default "bg-gray-50"}}">
            <tr>
                {{if .Selectable}}
                <th scope="col" class="relative px-6 py-3 text-left">
                    <input type="checkbox" 
                           {{if .Alpine.SelectAll}}{{.Alpine.SelectAll | renderAlpineAttrs}}{{end}}
                           class="absolute left-4 top-1/2 -mt-2 h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                </th>
                {{end}}
                {{range .Columns}}
                <th scope="col" class="{{.CSS | default "px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}}">
                    {{if .Sortable}}
                    <button type="button" 
                            {{if .HTMX}}{{.HTMX | renderHTMXAttrs}}{{end}}
                            class="group inline-flex">
                        {{.Label}}
                        <span class="ml-2 flex-none rounded text-gray-400 group-hover:visible group-focus:visible">
                            <i class="fas fa-sort"></i>
                        </span>
                    </button>
                    {{else}}
                    {{.Label}}
                    {{end}}
                </th>
                {{end}}
                {{if .RowActions}}
                <th scope="col" class="relative px-6 py-3">
                    <span class="sr-only">Actions</span>
                </th>
                {{end}}
            </tr>
        </thead>
        <tbody class="{{.CSS.Body | default "bg-white divide-y divide-gray-200"}}">
            {{range .Rows}}
            <tr class="{{if $.CSS.Row}}{{$.CSS.Row}}{{else}}hover:bg-gray-50{{end}}">
                {{if $.Selectable}}
                <td class="relative px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                    <input type="checkbox" 
                           name="selected[]" 
                           value="{{.ID}}"
                           {{if $.Alpine.SelectRow}}{{$.Alpine.SelectRow | renderAlpineAttrs}}{{end}}
                           class="absolute left-4 top-1/2 -mt-2 h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                </td>
                {{end}}
                {{range $colIndex, $column := $.Columns}}
                <td class="{{$column.CSS.Cell | default "px-6 py-4 whitespace-nowrap text-sm text-gray-900"}}">
                    {{$value := index $.Values $colIndex}}
                    {{if $column.Format}}
                        {{if eq $column.Format "badge"}}
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium {{$column.CSS.Badge | default "bg-green-100 text-green-800"}}">
                            {{$value}}
                        </span>
                        {{else if eq $column.Format "avatar"}}
                        <div class="flex items-center">
                            <div class="flex-shrink-0 h-10 w-10">
                                <img class="h-10 w-10 rounded-full" src="{{$value}}" alt="">
                            </div>
                        </div>
                        {{else if eq $column.Format "link"}}
                        <a href="{{$column.URL}}" class="text-indigo-600 hover:text-indigo-900">{{$value}}</a>
                        {{else if eq $column.Format "date"}}
                        <time datetime="{{$value}}">{{$value | formatDate}}</time>
                        {{else if eq $column.Format "currency"}}
                        <span class="text-gray-900 font-medium">{{$value | formatCurrency}}</span>
                        {{else}}
                        {{$value}}
                        {{end}}
                    {{else}}
                        {{$value}}
                    {{end}}
                </td>
                {{end}}
                {{if $.RowActions}}
                <td class="relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6">
                    <div class="flex items-center justify-end space-x-2">
                        {{range $.RowActions}}
                        <button type="button" 
                                {{if .HTMX}}{{.HTMX | renderHTMXAttrs}}{{end}}
                                {{if .Alpine}}{{.Alpine | renderAlpineAttrs}}{{end}}
                                class="{{.CSS | default "text-indigo-600 hover:text-indigo-900"}}">
                            {{if .Icon}}<i class="{{.Icon}}"></i>{{else}}{{.Label}}{{end}}
                        </button>
                        {{end}}
                    </div>
                </td>
                {{end}}
            </tr>
            {{end}}
        </tbody>
    </table>
    
    <!-- Empty State -->
    {{if .EmptyState}}
    <div class="text-center py-12">
        <div class="mx-auto h-12 w-12 text-gray-400">
            <i class="{{.EmptyState.Icon | default "fas fa-inbox"}} text-4xl"></i>
        </div>
        <h3 class="mt-2 text-sm font-medium text-gray-900">{{.EmptyState.Title | default "No data"}}</h3>
        <p class="mt-1 text-sm text-gray-500">{{.EmptyState.Description}}</p>
        {{if .EmptyState.Action}}
        <div class="mt-6">
            <button type="button" 
                    {{if .EmptyState.Action.HTMX}}{{.EmptyState.Action.HTMX | renderHTMXAttrs}}{{end}}
                    class="{{.EmptyState.Action.CSS | default "inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"}}">
                {{if .EmptyState.Action.Icon}}<i class="{{.EmptyState.Action.Icon}} mr-2"></i>{{end}}
                {{.EmptyState.Action.Label}}
            </button>
        </div>
        {{end}}
    </div>
    {{end}}
    
    <!-- Pagination -->
    {{if .Pagination}}
    <div class="{{.CSS.Pagination | default "bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"}}">
        <div class="flex-1 flex justify-between sm:hidden">
            <!-- Mobile pagination -->
            <button {{if .Pagination.HTMX.Previous}}{{.Pagination.HTMX.Previous | renderHTMXAttrs}}{{end}}
                    {{if not .Pagination.HasPrevious}}disabled{{end}}
                    class="relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
                Previous
            </button>
            <button {{if .Pagination.HTMX.Next}}{{.Pagination.HTMX.Next | renderHTMXAttrs}}{{end}}
                    {{if not .Pagination.HasNext}}disabled{{end}}
                    class="ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
                Next
            </button>
        </div>
        <div class="hidden sm:flex-1 sm:flex sm:items-center sm:justify-between">
            <div>
                <p class="text-sm text-gray-700">
                    Showing <span class="font-medium">{{.Pagination.From}}</span> to <span class="font-medium">{{.Pagination.To}}</span> of
                    <span class="font-medium">{{.Pagination.Total}}</span> results
                </p>
            </div>
            <div>
                <nav class="relative z-0 inline-flex rounded-md shadow-sm -space-x-px" aria-label="Pagination">
                    <!-- Pagination links would be generated here -->
                </nav>
            </div>
        </div>
    </div>
    {{end}}
</div>
{{end}}
