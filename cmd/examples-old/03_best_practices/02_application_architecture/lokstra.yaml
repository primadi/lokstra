server:
  name: "application_architecture_example"
  global_setting:
    log_level: "info"

services:
  - name: "logger"
    type: "lokstra.logger"
    config:
      level: "info"
      format: "json"
      output: "stdout"

  - name: "db_pool"
    type: "lokstra.dbpool.pg"
    config:
      # Update these settings for your database
      host: "localhost"
      port: 5432
      database: "lokstra_example"
      username: "postgres"
      password: "password"
      max_connections: 25
      min_connections: 5
      max_idle_time: "30m"
      max_lifetime: "1h"
      ssl_mode: "disable"

apps:
  - name: "main_app"
    address: ":8080"
    listener_type: "default"
    router_engine_type: "default"
    
    middleware:
      - name: "request_logger"
        enabled: true
      - name: "recovery"
        enabled: true
      - name: "cors"
        enabled: true
        config:
          allowed_origins: ["*"]
          allowed_methods: ["GET", "POST", "PUT", "DELETE", "OPTIONS"]
          allowed_headers: ["*"]
          
    groups:
      - prefix: "/api"
        routes:
          - method: "GET"
            path: "/health"
            handler: "health.check"
            
        groups:
          - prefix: "/users"
            routes:
              - method: "GET"
                path: ""
                handler: "user_management.list_users"
              - method: "GET"
                path: "/:id"
                handler: "user_management.get_user"
              - method: "POST"
                path: ""
                handler: "user_management.create_user"
              - method: "PUT"
                path: "/:id"
                handler: "user_management.update_user"
              - method: "DELETE"
                path: "/:id"
                handler: "user_management.delete_user"
